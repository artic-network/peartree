<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PearTree — Phylogenetic Tree Viewer</title>

  <!-- Bootstrap 5 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />

  <style>
    /*
     * Palette derived from DEFAULT_THEME in treerenderer.js:
     *   bg           #02292E  deep dark teal
     *   branch/text  #F2F1E6  warm off-white
     *   tip          #BF4B43  muted coral-red
     *   internal     #19A699  teal accent
     *   label        #F7EECA  warm cream
     *   dimLabel     #E6D595  muted gold
     */
    :root {
      --pt-bg:       #02292E;
      --pt-bg-dark:  #021E22;
      --pt-border:   #05494F;
      --pt-red:      #BF4B43;
      --pt-teal:     #19A699;
      --pt-cream:    #F7EECA;
      --pt-gold:     #E6D595;
      --pt-off-white:#F2F1E6;
      --pt-btn-bg:   #033A42;
      --pt-btn-bdr:  #066878;
      --pt-btn-hover:#04545E;
    }

    /* ── Layout ── */
    html, body { height: 100%; overflow: hidden; }
    body {
      display: flex;
      flex-direction: column;
      background: var(--pt-bg);
      color: var(--pt-off-white);
    }

    /* ── Navbar overrides ── */
    .navbar {
      background: var(--pt-bg-dark) !important;
      border-bottom: 1px solid var(--pt-border);
      min-height: 46px;
      padding: 0 1rem;
    }
    .navbar-brand {
      font-size: 1rem;
      font-weight: 600;
      color: var(--pt-red) !important;
      letter-spacing: 0.4px;
      padding: 0;
    }
    #file-info {
      font-size: 0.75rem;
      color: var(--pt-gold);
      opacity: 0.75;
    }

    /* ── Sliders ── */
    .form-label-sm { font-size: 0.75rem; color: var(--pt-gold); margin-bottom: 0; }
    .form-range { width: 90px; accent-color: var(--pt-red); }

    /* ── Buttons ── */
    .btn-pt {
      background: var(--pt-btn-bg);
      color: var(--pt-off-white);
      border: 1px solid var(--pt-btn-bdr);
      font-size: 0.75rem;
      padding: 3px 10px;
      transition: background .15s;
    }
    .btn-pt:hover:not(:disabled) { background: var(--pt-btn-hover); color: var(--pt-off-white); }
    .btn-pt:disabled { opacity: 0.35; }
    .btn-pt.active  { background: var(--pt-red); border-color: var(--pt-red); color: var(--pt-cream); }

    /* ── Canvas area ── */
    #canvas-container {
      flex: 1;
      position: relative;
      overflow: hidden;
    }
    canvas            { display: block; cursor: default; }
    canvas.space      { cursor: grab; }
    canvas.grabbing   { cursor: grabbing; }

    /* ── Status bar ── */
    #status {
      position: absolute;
      bottom: 8px;
      left: 12px;
      font-size: 0.7rem;
      color: var(--pt-teal);
      opacity: 0.6;
      pointer-events: none;
    }

    /* ── Loading overlay ── */
    #loading {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--pt-bg);
      gap: 14px;
    }
    #loading p { font-size: 0.875rem; color: var(--pt-gold); }
    .pt-spinner {
      width: 36px; height: 36px;
      border: 3px solid #044D59;
      border-top-color: var(--pt-red);
      border-radius: 50%;
      animation: pt-spin 0.8s linear infinite;
    }
    @keyframes pt-spin { to { transform: rotate(360deg); } }

    /* ── Error overlay ── */
    #error {
      display: none;
      position: absolute;
      inset: 0;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--pt-bg);
      gap: 10px;
      color: var(--pt-red);
      font-size: 0.875rem;
      padding: 40px;
      text-align: center;
    }

    /* ── Tooltip ── */
    #tooltip {
      position: absolute;
      background: rgba(3,58,66,0.97);
      border: 1px solid var(--pt-btn-bdr);
      border-radius: 4px;
      padding: 5px 10px;
      font-size: 0.7rem;
      color: var(--pt-off-white);
      pointer-events: none;
      display: none;
      max-width: 320px;
      word-break: break-all;
      z-index: 10;
      line-height: 1.6;
    }
  </style>
</head>
<body>

<nav class="navbar">
  <span class="navbar-brand">PearTree</span>
  <span id="file-info" class="me-3">Loading…</span>

  <div class="d-flex align-items-center gap-2 ms-auto flex-wrap">
    <label class="d-flex align-items-center gap-1">
      <span class="form-label-sm">Label size</span>
      <input type="range" class="form-range" id="font-size-slider" min="6" max="20" value="11" />
    </label>
    <label class="d-flex align-items-center gap-1">
      <span class="form-label-sm">Tip size</span>
      <input type="range" class="form-range" id="tip-size-slider" min="1" max="12" value="3" />
    </label>
    <button id="btn-back"       class="btn btn-pt" disabled title="Navigate back (⌘[)">&#8249;</button>
    <button id="btn-forward"    class="btn btn-pt" disabled title="Navigate forward (⌘])">&#8250;</button>
    <button id="btn-order-asc"  class="btn btn-pt" title="Order branches descending by tip count (⌘D)">Order ↑</button>
    <button id="btn-order-desc" class="btn btn-pt" title="Order branches ascending by tip count (⌘U)">Order ↓</button>
    <button id="btn-fit"        class="btn btn-pt" title="Fit all (⌘0)">Fit all</button>
    <button id="btn-fit-labels" class="btn btn-pt" title="Fit labels (⌘⌥0)">Fit labels</button>
  </div>
</nav>

<div id="canvas-container">
  <div id="loading"><div class="pt-spinner"></div><p id="loading-msg">Fetching tree file…</p></div>
  <div id="error"></div>
  <canvas id="tree-canvas"></canvas>
  <div id="status"></div>
  <div id="tooltip"></div>
</div>

<script type="module" src="js/peartree.js"></script>
</body>
</html>
